# prometheus-values.yaml (PRODUCTION)

grafana:
  enabled: true

  adminUser: admin
  adminPassword: admin   # ⚠️ nên chuyển sang existingSecret sau

  persistence:
    enabled: true
    storageClassName: vngcloud-ssd-3000-delete
    accessModes:
      - ReadWriteOnce
    size: 3Gi

  service:
    type: ClusterIP
    port: 80

  # Tránh lỗi PVC RWO khi rollout
  deploymentStrategy:
    type: Recreate

alertmanager:
  enabled: false

prometheus:
  service:
    type: ClusterIP
    port: 9090

  prometheusSpec:
    # ======================
    # Core behavior
    # ======================
    retention: 7d
    scrapeInterval: 30s
    evaluationInterval: 60s

    # ======================
    # VERY IMPORTANT
    # ======================
    externalLabels:
      cluster: production
      environment: production

    # ======================
    # Storage
    # ======================
    storageSpec:
      volumeClaimTemplate:
        spec:
          storageClassName: vngcloud-ssd-3000-delete
          accessModes:
            - ReadWriteOnce
          resources:
            requests:
              storage: 20Gi

    # ======================
    # Performance & safety
    # ======================
    enableAdminAPI: false
    walCompression: true

    # ======================
    # (Optional) Remote write receiver
    # ======================
    # Nếu PROD nhận metric từ STAGING
    enableRemoteWriteReceiver: true
